# 技术栈与依赖

<cite>
**本文档引用的文件**  
- [package.json](file://package.json)
- [next.config.js](file://next.config.js)
- [tsconfig.json](file://tsconfig.json)
- [tailwind.config.js](file://tailwind.config.js)
- [prisma/schema.prisma](file://prisma/schema.prisma)
- [app/layout.tsx](file://app/layout.tsx)
- [app/page.tsx](file://app/page.tsx)
- [lib/prisma.ts](file://lib/prisma.ts)
- [lib/api.ts](file://lib/api.ts)
- [lib/types.ts](file://lib/types.ts)
- [lib/utils.ts](file://lib/utils.ts)
- [components/Editor.tsx](file://components/Editor.tsx)
- [components/Sidebar.tsx](file://components/Sidebar.tsx)
- [app/api/logs/route.ts](file://app/api/logs/route.ts)
- [app/api/summary/route.ts](file://app/api/summary/route.ts)
- [config/env.example](file://config/env.example)
</cite>

## 目录
1. [技术栈概览](#技术栈概览)
2. [核心框架与库](#核心框架与库)
3. [前端技术栈](#前端技术栈)
4. [后端与数据层](#后端与数据层)
5. [AI能力集成](#ai能力集成)
6. [关键依赖包](#关键依赖包)
7. [版本兼容性与构建流程](#版本兼容性与构建流程)
8. [配置文件说明](#配置文件说明)

## 技术栈概览

AI1_Log项目采用现代化全栈技术架构，基于Next.js 14的App Router模式构建，结合React 18的组件化开发与Hooks状态管理，使用TypeScript确保类型安全，通过Tailwind CSS实现原子化样式设计。数据持久化层采用Prisma ORM与SQLite数据库，AI能力通过DeepSeek API集成。项目结构清晰，前后端一体化，支持服务端渲染与API路由。

**Section sources**
- [package.json](file://package.json)
- [next.config.js](file://next.config.js)
- [tsconfig.json](file://tsconfig.json)

## 核心框架与库

### Next.js 14 (App Router 模式)
项目采用Next.js 14作为核心框架，使用App Router模式而非传统的Pages Router。App Router基于React Server Components，支持服务端渲染(SSR)、静态生成(SSG)和客户端渲染(CSR)的灵活组合，提升了首屏加载性能和SEO优化能力。路由文件位于`app/`目录下，通过文件系统自动映射路由。

### React 18 (组件化与Hooks)
项目基于React 18构建，充分利用函数式组件和Hooks进行状态管理。使用`useState`、`useEffect`等核心Hooks管理组件状态和副作用，实现响应式UI更新。组件设计遵循单一职责原则，如`Editor`、`Sidebar`、`SummaryGenerator`等均封装为独立可复用组件。

### TypeScript (类型安全)
项目全程使用TypeScript，通过静态类型检查提升代码质量和开发体验。定义了`LogEntry`、`Block`等核心数据类型，确保数据结构的一致性和类型安全。类型定义位于`lib/types.ts`，在API调用、组件props等场景中广泛使用。

**Section sources**
- [package.json](file://package.json)
- [app/page.tsx](file://app/page.tsx)
- [lib/types.ts](file://lib/types.ts)

## 前端技术栈

### Tailwind CSS (原子化样式)
项目采用Tailwind CSS作为CSS框架，使用原子化类名直接在JSX中编写样式。通过`className`属性组合实用类实现响应式设计，如`flex`、`grid`、`p-4`、`text-slate-800`等。自定义配置了`primary`调色板和`Noto Sans SC`字体，确保视觉一致性。

### 组件化架构
项目前端由多个功能组件构成：
- `Sidebar`：日志列表展示与管理，支持拖拽排序
- `Editor`：富文本编辑器，支持标题、待办事项等区块类型
- `SummaryGenerator`：AI周报生成界面

组件间通过props传递数据和回调函数，实现松耦合通信。

**Section sources**
- [tailwind.config.js](file://tailwind.config.js)
- [components/Editor.tsx](file://components/Editor.tsx)
- [components/Sidebar.tsx](file://components/Sidebar.tsx)

## 后端与数据层

### Prisma ORM (数据库访问层)
项目使用Prisma作为TypeScript的ORM工具，提供类型安全的数据库访问。`prisma/schema.prisma`定义了`LogEntry`模型，包含ID、创建时间、标题、内容等字段。Prisma Client自动生成类型化的查询API，简化数据库操作。

### SQLite (本地持久化存储)
采用SQLite作为本地数据库，轻量级且无需独立服务。数据库文件为`dev.db`，通过Prisma进行模式同步。适合个人日志应用的轻量级数据存储需求，支持基本的CRUD操作和查询。

### API路由
项目使用Next.js的API路由功能，位于`app/api/`目录：
- `logs/route.ts`：处理日志的增删改查
- `summary/route.ts`：调用DeepSeek API生成周报

API路由基于Next.js的`NextRequest`和`NextResponse`，实现RESTful接口。

**Section sources**
- [prisma/schema.prisma](file://prisma/schema.prisma)
- [lib/prisma.ts](file://lib/prisma.ts)
- [app/api/logs/route.ts](file://app/api/logs/route.ts)

## AI能力集成

### DeepSeek API (AI能力集成)
项目通过DeepSeek API实现AI周报生成功能。在`app/api/summary/route.ts`中，将用户日志内容作为上下文发送至DeepSeek的`deepseek-chat`模型，生成结构化的Markdown周报。系统提示词(system prompt)定义了周报格式，包括本周概述、完成事项、进行中任务和下周计划。

API密钥通过环境变量`DEEPSEEK_API_KEY`配置，确保安全性。请求包含模型参数如`temperature`和`max_tokens`，控制生成内容的创造性和长度。

**Section sources**
- [app/api/summary/route.ts](file://app/api/summary/route.ts)
- [config/env.example](file://config/env.example)

## 关键依赖包

### 核心依赖
- `next`: Next.js框架核心，版本^14.2.0
- `react` 和 `react-dom`: React 18核心库
- `@prisma/client`: Prisma数据库客户端
- `lucide-react`: 图标库，提供`Plus`、`Trash2`等SVG图标

### 开发依赖
- `typescript`: TypeScript编译器
- `prisma`: Prisma CLI工具
- `tailwindcss`: Tailwind CSS核心
- `autoprefixer` 和 `postcss`: CSS处理工具

这些依赖包共同支撑项目的开发、构建和运行。

**Section sources**
- [package.json](file://package.json)

## 版本兼容性与构建流程

### 版本兼容性
项目依赖版本经过精心选择以确保兼容性：
- Next.js 14 与 React 18 完全兼容
- TypeScript ~5.8.2 支持现代ES特性
- Prisma ^5.15.0 与Next.js 14良好集成
- Tailwind CSS ^3.4.4 提供最新实用类

### 构建工具链 (npm scripts)
项目通过npm scripts定义工作流程：
- `dev`: 启动开发服务器 (`next dev`)
- `build`: 构建生产版本，先生成Prisma客户端再构建Next.js应用
- `start`: 启动生产服务器
- `db:push`: 将Prisma模式推送到数据库
- `db:studio`: 启动Prisma Studio数据库管理界面

构建流程自动化程度高，`build`脚本确保Prisma客户端在Next.js构建前生成。

**Section sources**
- [package.json](file://package.json)
- [next.config.js](file://next.config.js)

## 配置文件说明

### next.config.js
Next.js配置文件，启用React严格模式，确保开发时的组件行为符合预期。

### tsconfig.json
TypeScript配置文件，设置模块解析、路径别名(`@/*`)、严格类型检查等选项，支持Next.js项目结构。

### tailwind.config.js
Tailwind CSS配置文件，定义内容扫描路径、扩展颜色调色板和字体配置。

### prisma/schema.prisma
Prisma模式文件，定义数据模型和数据库连接，使用SQLite提供本地持久化。

**Section sources**
- [next.config.js](file://next.config.js)
- [tsconfig.json](file://tsconfig.json)
- [tailwind.config.js](file://tailwind.config.js)
- [prisma/schema.prisma](file://prisma/schema.prisma)